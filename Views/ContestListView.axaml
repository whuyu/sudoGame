<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:converters="using:Avalonia.Data.Converters"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="SudokuGame.Views.ContestListView">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="在线比赛" 
                 FontSize="24" 
                 FontWeight="Bold"
                 HorizontalAlignment="Center"
                 Margin="0,20,0,20"/>

        <ScrollViewer Grid.Row="1">
            <ItemsControl x:Name="ContestList">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="White"
                                Margin="20,10"
                                CornerRadius="8"
                                BoxShadow="0 2 10 0 #15000000">
                            <Grid Margin="20">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="{Binding Title}"
                                         FontSize="20"
                                         FontWeight="Bold"/>

                                <TextBlock Grid.Row="1"
                                         Text="{Binding Description}"
                                         Margin="0,10,0,10"/>

                                <Grid Grid.Row="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel>
                                        <TextBlock>
                                            <Run Text="开始时间："/>
                                            <Run Text="{Binding StartTime, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}"/>
                                        </TextBlock>
                                        <TextBlock>
                                            <Run Text="比赛时长："/>
                                            <Run Text="{Binding Duration}"/>
                                            <Run Text="分钟"/>
                                        </TextBlock>
                                        <TextBlock>
                                            <Run Text="状态："/>
                                            <Run Text="{Binding Status}"/>
                                        </TextBlock>
                                    </StackPanel>

                                    <Button Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Classes.primary="{Binding !HasJoined}"
                                            Click="JoinContest_Click">
                                        <Panel>
                                            <TextBlock IsVisible="{Binding !HasJoined}" Text="加入比赛"/>
                                            <TextBlock IsVisible="{Binding HasJoined}" Text="查看比赛"/>
                                        </Panel>
                                        <Button.Styles>
                                            <Style Selector="Button.primary">
                                                <Setter Property="Background" Value="#409EFF"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Style>
                                        </Button.Styles>
                                    </Button>
                                </Grid>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl> 